import Dexie from 'dexie';

const db = new Dexie('dictionary');
db.version(1).stores({
    recentlyWords: `++id, query, created, title, url, [query+created]`
});
//db.open();

async function getRecentlyListAll() {
    return await db.table('recentlyWords').orderBy('id').reverse().toArray();
}

async function getRecentlyList(page) {
    let offset = ((page || 1) - 1) * 20;
    return await db.table('recentlyWords').orderBy('id').reverse().offset(offset).limit(20).toArray();
}

async function getRecentlyCount() {
    return await db.table('recentlyWords').count();
}

async function getRecentlyPages() {
    return (parseInt(await getRecentlyCount() / 20) + 1);
}

async function restoreDb() {
    let json = `[{"query":"申报","results":{"end":5,"items":[{"alias":"","aliasID":0,"antonym":"","antonymID":0,"ascPinyin":"shenbao","bctLevel":1,"cnExplain":"","destinationLink":"http://cndic.naver.com/zh/entry?entryID=c_3ef2bcebac05a32b","dicType":"zh","encEntryID":"c_3ef2bcebac05a32b","encMeans":"","entryID":"1068593","entryName":"<strong>申报</strong>","entryNameTTS":"申报","etcMeans":"","fantizi":"","firstMeans":"","frequency":0,"gdid":"8817843c_00000f2e0000000000104e31","hangulMean":"","hangulPronun":"","hskPriority":0,"imageFileCount":0,"imageFileList":["https://dic-phinf.pstatic.net/20180509_71/1525848263627PpDB5_JPEG/15948_getty_20080128162519.jpg"],"imageFiles":"https://dic-phinf.pstatic.net/20180509_71/1525848263627PpDB5_JPEG/15948_getty_20080128162519.jpg","isLetter":"false","krExplain":"","managedMeans":"","matchType":"exact:entry","matchedList":[],"meanList":[{"createDate":null,"distinguishingSynonyms":"","encEntryID":"c_3333","entryID":0,"entryName":"","erRhyme":"","examples":[],"footerName":"","footerWord":"","headerUsage":"","hlMean":"","isOpen":"0","krExplain":"","matchedExampleOpen":false,"mean":"(서면(書面)으로) 상급 기관이나 관련 기관에 보고하다. (주로 법령 문서(法令文書...","meanExtends":"","meanID":0,"meanLevel":"","open":false,"parts":"2","partsLabel":"동사","pinyin":"","pole":"","poleLabel":"","priority":0,"relatedMeanInfos":[],"seq":1,"standardSpeech":"","updateDate":null,"usages":""},{"createDate":null,"distinguishingSynonyms":"","encEntryID":"c_3333","entryID":0,"entryName":"","erRhyme":"","examples":[],"footerName":"","footerWord":"","headerUsage":"","hlMean":"","isOpen":"0","krExplain":"","matchedExampleOpen":false,"mean":"(세관에) 신고하다.","meanExtends":"","meanID":0,"meanLevel":"","open":false,"parts":"2","partsLabel":"동사","pinyin":"","pole":"","poleLabel":"","priority":0,"relatedMeanInfos":[],"seq":2,"standardSpeech":"","updateDate":null,"usages":""},{"createDate":null,"distinguishingSynonyms":"","encEntryID":"c_3333","entryID":0,"entryName":"","erRhyme":"","examples":[],"footerName":"","footerWord":"","headerUsage":"","hlMean":"","isOpen":"0","krExplain":"","matchedExampleOpen":false,"mean":"신고. 보고.","meanExtends":"","meanID":0,"meanLevel":"","open":false,"parts":"1","partsLabel":"명사","pinyin":"","pole":"","poleLabel":"","priority":0,"relatedMeanInfos":[],"seq":3,"standardSpeech":"","updateDate":null,"usages":""}],"newHskPriority":6,"numPinyin":"shen1bao4","pinyin":"shēnbào","position":"","pronunFileCount":0,"pronunFileMap":{"female":"https://dict-dn.pstatic.net/naver/dic/naverdic/cndic/female/s/f-shen1bao4.mp3?_lsu_sa_=3a18da5eed0a39d6a599e19b31048cfc4d8968d5170afff56112cf7b7b9e6251505727b96f256b7fe98c6b251e2d10619a82fced49b26df52a2633ce6bf437c92c2262028033693664e258881c70b24a","male":"https://dict-dn.pstatic.net/naver/dic/naverdic/cndic/male/s/m-shen1bao4.mp3?_lsu_sa_=3318175d5db238d6379af1c937d469f8dd0463f545031fe66672ed795b3d6d51cc5c27e866f5aa7139d16e35fb2bb03922ff9066570436a331c3051adf8d49629560a78aaa57490ef087669c2f81ae86"},"pronunFiles":"","romeLang":"","searchType":{"code":"word","enumClass":"com.naver.cndic.model.constants.SearchConstants","label":"단어","name":"word","sscode":"ckword"},"secondMeans":"","source":"고려대 중한사전","sourceScore":"","supNo":"0","synonym":"","synonymID":0,"thirdMeans":"","vcode":"630337","weight":0,"yitizi":""},{"alias":"","aliasID":0,"antonym":"","antonymID":0,"ascPinyin":"shenbaodan","bctLevel":0,"cnExplain":"","destinationLink":"http://cndic.naver.com/zh/entry?entryID=c_3cf1b1e4a90f7a","dicType":"zh","encEntryID":"c_3cf1b1e4a90f7a","encMeans":"","entryID":"119521","entryName":"申报单","entryNameTTS":"申报单","etcMeans":"","fantizi":"","firstMeans":"","frequency":0,"gdid":"00000098_00000f2e000000000001d2e1","hangulMean":"","hangulPronun":"","hskPriority":0,"imageFileCount":0,"imageFileList":[],"imageFiles":"","isLetter":"false","krExplain":"","managedMeans":"","matchType":"allterm:proximity:0.000000","matchedList":[],"meanList":[{"createDate":null,"distinguishingSynonyms":"","encEntryID":"c_3333","entryID":0,"entryName":"","erRhyme":"","examples":[],"footerName":"","footerWord":"","headerUsage":"","hlMean":"","isOpen":"0","krExplain":"","matchedExampleOpen":false,"mean":"신고서 (declaration)","meanExtends":"","meanID":0,"meanLevel":"","open":false,"parts":"0","partsLabel":"","pinyin":"","pole":"","poleLabel":"","priority":0,"relatedMeanInfos":[],"seq":1,"standardSpeech":"","updateDate":null,"usages":""}],"newHskPriority":0,"numPinyin":"shen1bao4dan1","pinyin":"shēnbàodān","position":"","pronunFileCount":0,"pronunFileMap":null,"pronunFiles":"","romeLang":"","searchType":null,"secondMeans":"","source":"경제무역어사전","sourceScore":"","supNo":"0","synonym":"","synonymID":0,"thirdMeans":"","vcode":"594234","weight":0,"yitizi":""},{"alias":"","aliasID":0,"antonym":"","antonymID":0,"ascPinyin":"weishenbao","bctLevel":0,"cnExplain":"","destinationLink":"http://cndic.naver.com/zh/entry?entryID=c_3ef2bde7ab0685","dicType":"zh","encEntryID":"c_3ef2bde7ab0685","encMeans":"","entryID":"325608","entryName":"未<strong>申报</strong>","entryNameTTS":"未申报","etcMeans":"","fantizi":"","firstMeans":"","frequency":0,"gdid":"08118D44_00000f2e000000000004f7e8","hangulMean":"","hangulPronun":"","hskPriority":0,"imageFileCount":0,"imageFileList":[],"imageFiles":"","isLetter":"false","krExplain":"","managedMeans":"","matchType":"allterm:proximity:0.000000","matchedList":[],"meanList":[{"createDate":null,"distinguishingSynonyms":"","encEntryID":"c_3333","entryID":0,"entryName":"","erRhyme":"","examples":[],"footerName":"","footerWord":"","headerUsage":"","hlMean":"","isOpen":"0","krExplain":"","matchedExampleOpen":false,"mean":"무신고","meanExtends":"","meanID":0,"meanLevel":"","open":false,"parts":"0","partsLabel":"","pinyin":"","pole":"4","poleLabel":"경제","priority":0,"relatedMeanInfos":[],"seq":1,"standardSpeech":"","updateDate":null,"usages":""}],"newHskPriority":0,"numPinyin":"wei4shen1bao4","pinyin":"wèishēnbào","position":"","pronunFileCount":0,"pronunFileMap":null,"pronunFiles":"","romeLang":"","searchType":null,"secondMeans":"","source":"삼정KPMG회계세무용어사전","sourceScore":"","supNo":"0","synonym":"","synonymID":0,"thirdMeans":"","vcode":"444821","weight":0,"yitizi":""},{"alias":"","aliasID":0,"antonym":"","antonymID":0,"ascPinyin":"shenbaoguogao","bctLevel":0,"cnExplain":"","destinationLink":"http://cndic.naver.com/zh/entry?entryID=c_3cf0b9e3ae0a80","dicType":"zh","encEntryID":"c_3cf0b9e3ae0a80","encMeans":"","entryID":"101254","entryName":"<strong>申报</strong>过高","entryNameTTS":"申报过高","etcMeans":"","fantizi":"","firstMeans":"","frequency":0,"gdid":"00000098_00000f2e0000000000018b86","hangulMean":"","hangulPronun":"","hskPriority":0,"imageFileCount":0,"imageFileList":[],"imageFiles":"","isLetter":"false","krExplain":"","managedMeans":"","matchType":"allterm:proximity:0.000000","matchedList":[],"meanList":[{"createDate":null,"distinguishingSynonyms":"","encEntryID":"c_3333","entryID":0,"entryName":"","erRhyme":"","examples":[],"footerName":"","footerWord":"","headerUsage":"","hlMean":"","isOpen":"0","krExplain":"","matchedExampleOpen":false,"mean":"고가신고 (overvalue)","meanExtends":"","meanID":0,"meanLevel":"","open":false,"parts":"0","partsLabel":"","pinyin":"","pole":"","poleLabel":"","priority":0,"relatedMeanInfos":[],"seq":1,"standardSpeech":"","updateDate":null,"usages":""}],"newHskPriority":0,"numPinyin":"shen1bao4guo4gao1","pinyin":"shēnbàoguògāo","position":"","pronunFileCount":0,"pronunFileMap":null,"pronunFiles":"","romeLang":"","searchType":null,"secondMeans":"","source":"경제무역어사전","sourceScore":"","supNo":"0","synonym":"","synonymID":0,"thirdMeans":"","vcode":"109607","weight":0,"yitizi":""},{"alias":"","aliasID":0,"antonym":"","antonymID":0,"ascPinyin":"shenbaoyiwu","bctLevel":0,"cnExplain":"","destinationLink":"http://cndic.naver.com/zh/entry?entryID=c_3cf0b9e7ad0d86","dicType":"zh","encEntryID":"c_3cf0b9e7ad0d86","encMeans":"","entryID":"101663","entryName":"<strong>申报</strong>义务","entryNameTTS":"申报义务","etcMeans":"","fantizi":"","firstMeans":"","frequency":0,"gdid":"00000098_00000f2e0000000000018d1f","hangulMean":"","hangulPronun":"","hskPriority":0,"imageFileCount":0,"imageFileList":[],"imageFiles":"","isLetter":"false","krExplain":"","managedMeans":"","matchType":"allterm:proximity:0.000000","matchedList":[],"meanList":[{"createDate":null,"distinguishingSynonyms":"","encEntryID":"c_3333","entryID":0,"entryName":"","erRhyme":"","examples":[],"footerName":"","footerWord":"","headerUsage":"","hlMean":"","isOpen":"0","krExplain":"","matchedExampleOpen":false,"mean":"보고의무 (Reporting obligations)","meanExtends":"","meanID":0,"meanLevel":"","open":false,"parts":"0","partsLabel":"","pinyin":"","pole":"","poleLabel":"","priority":0,"relatedMeanInfos":[],"seq":1,"standardSpeech":"","updateDate":null,"usages":""}],"newHskPriority":0,"numPinyin":"shen1bao4yi4wu4","pinyin":"shēnbàoyìwù","position":"","pronunFileCount":0,"pronunFileMap":null,"pronunFiles":"","romeLang":"","searchType":null,"secondMeans":"","source":"경제무역어사전","sourceScore":"","supNo":"0","synonym":"","synonymID":0,"thirdMeans":"","vcode":"520149","weight":0,"yitizi":""}],"morphemes":0,"page":0,"pageAndPageSize":"","start":1,"startRow":0,"total":332,"totalPage":0},"url":"http://baijiahao.baidu.com/s?id=1625614604341323647","title":"个税零申报=没有纳税记录？国家税务总局回应","created":"2019-02-16T23:26:25.979Z","id":66}]`;
    let data = JSON.parse(json);
    data = data[0];
    await delete data.id;
    for (var i = 0; i< 99; i++) {
        await db.table('recentlyWords').add(data);
    }
}

export default {
    getRecentlyList,
    getRecentlyCount,
    getRecentlyPages,
    restoreDb,
    getRecentlyListAll,
};